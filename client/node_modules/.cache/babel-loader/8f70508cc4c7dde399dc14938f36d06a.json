{"ast":null,"code":"import _objectSpread from \"C:/Users/1867792/up_pro/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\n/* global document */\nimport * as React from 'react';\nimport { createPortal } from 'react-dom';\nimport { useEffect, useMemo, useRef, useContext } from 'react';\nimport { applyReactStyle } from '../utils/apply-react-style';\nimport { MapContext } from './map';\nimport { arePointsEqual } from '../utils/deep-equal';\nvar defaultProps = {\n  draggable: false,\n  popup: null,\n  rotation: 0,\n  rotationAlignment: 'auto',\n  pitchAlignment: 'auto'\n};\n/* eslint-disable complexity,max-statements */\nfunction Marker(props) {\n  var _useContext = useContext(MapContext),\n    map = _useContext.map,\n    mapLib = _useContext.mapLib;\n  var thisRef = useRef({\n    props: props\n  });\n  thisRef.current.props = props;\n  var marker = useMemo(function () {\n    var hasChildren = false;\n    React.Children.forEach(props.children, function (el) {\n      if (el) {\n        hasChildren = true;\n      }\n    });\n    var options = _objectSpread(_objectSpread({}, props), {}, {\n      element: hasChildren ? document.createElement('div') : null\n    });\n    var mk = new mapLib.Marker(options).setLngLat([props.longitude, props.latitude]);\n    mk.getElement().addEventListener('click', function (e) {\n      var _a, _b;\n      (_b = (_a = thisRef.current.props).onClick) === null || _b === void 0 ? void 0 : _b.call(_a, {\n        type: 'click',\n        target: mk,\n        originalEvent: e\n      });\n    });\n    mk.on('dragstart', function (e) {\n      var _a, _b;\n      var evt = e;\n      evt.lngLat = marker.getLngLat();\n      (_b = (_a = thisRef.current.props).onDragStart) === null || _b === void 0 ? void 0 : _b.call(_a, evt);\n    });\n    mk.on('drag', function (e) {\n      var _a, _b;\n      var evt = e;\n      evt.lngLat = marker.getLngLat();\n      (_b = (_a = thisRef.current.props).onDrag) === null || _b === void 0 ? void 0 : _b.call(_a, evt);\n    });\n    mk.on('dragend', function (e) {\n      var _a, _b;\n      var evt = e;\n      evt.lngLat = marker.getLngLat();\n      (_b = (_a = thisRef.current.props).onDragEnd) === null || _b === void 0 ? void 0 : _b.call(_a, evt);\n    });\n    return mk;\n  }, []);\n  useEffect(function () {\n    marker.addTo(map.getMap());\n    return function () {\n      marker.remove();\n    };\n  }, []);\n  useEffect(function () {\n    applyReactStyle(marker.getElement(), props.style);\n  }, [props.style]);\n  if (marker.getLngLat().lng !== props.longitude || marker.getLngLat().lat !== props.latitude) {\n    marker.setLngLat([props.longitude, props.latitude]);\n  }\n  if (props.offset && !arePointsEqual(marker.getOffset(), props.offset)) {\n    marker.setOffset(props.offset);\n  }\n  if (marker.isDraggable() !== props.draggable) {\n    marker.setDraggable(props.draggable);\n  }\n  if (marker.getRotation() !== props.rotation) {\n    marker.setRotation(props.rotation);\n  }\n  if (marker.getRotationAlignment() !== props.rotationAlignment) {\n    marker.setRotationAlignment(props.rotationAlignment);\n  }\n  if (marker.getPitchAlignment() !== props.pitchAlignment) {\n    marker.setPitchAlignment(props.pitchAlignment);\n  }\n  if (marker.getPopup() !== props.popup) {\n    marker.setPopup(props.popup);\n  }\n  return createPortal(props.children, marker.getElement());\n}\nMarker.defaultProps = defaultProps;\n// @ts-ignore\nexport default React.memo(Marker);","map":{"version":3,"mappings":"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","names":["React","createPortal","useEffect","useMemo","useRef","useContext","applyReactStyle","MapContext","arePointsEqual","defaultProps","draggable","popup","rotation","rotationAlignment","pitchAlignment","Marker","props","map","mapLib","thisRef","current","marker","hasChildren","Children","forEach","children","el","options","element","document","createElement","mk","setLngLat","longitude","latitude","getElement","addEventListener","e","onClick","type","target","originalEvent","on","evt","lngLat","getLngLat","onDragStart","onDrag","onDragEnd","addTo","getMap","remove","style","lng","lat","offset","getOffset","setOffset","isDraggable","setDraggable","getRotation","setRotation","getRotationAlignment","setRotationAlignment","getPitchAlignment","setPitchAlignment","getPopup","setPopup","memo"],"sourceRoot":"","sources":["../../../src/components/marker.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}